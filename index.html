<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>投票問卷系統</title>
    <!-- Bootstrap CSS for styling -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5/dist/css/bootstrap.min.css">
    <!-- Custom styles -->
    <link rel="stylesheet" href="src/style.css">
</head>
<body>
    <div class="container mt-5">
        <!-- Create Poll Section -->
        <div id="createPollSection" class="card mb-4">
            <div class="card-header">
                <h5>建立投票</h5>
            </div>
            <div class="card-body">
                <form id="createPollForm">
                    <div class="mb-3">
                        <label for="pollTitle" class="form-label">投票標題</label>
                        <input type="text" class="form-control" id="pollTitle" placeholder="請輸入投票標題" required>
                    </div>

                    <div class="mb-3">
                        <label for="pollType" class="form-label">題目類型</label>
                        <select class="form-select" id="pollType">
                            <option value="single">單選</option>
                            <option value="multiple">多選</option>
                        </select>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">投票選項</label>
                        <div id="optionsContainer">
                            <div class="input-group mb-2">
                                <input type="text" class="form-control poll-option" placeholder="選項 1">
                                <button class="btn btn-outline-danger" type="button" onclick="removeOption(this)">移除</button>
                            </div>
                            <div class="input-group mb-2">
                                <input type="text" class="form-control poll-option" placeholder="選項 2">
                                <button class="btn btn-outline-danger" type="button" onclick="removeOption(this)">移除</button>
                            </div>
                        </div>
                        <button type="button" class="btn btn-secondary" onclick="addOption()">+ 新增選項</button>
                    </div>

                    <button type="submit" class="btn btn-primary">建立投票</button>
                </form>
            </div>
        </div>

        <!-- Vote Section -->
        <div id="voteSectionContainer" style="display: none;">
            <div id="votingArea" class="card">
                <div class="card-header">
                    <h5 id="votePollTitle">投票標題</h5>
                </div>
                <div class="card-body">
                    <form id="voteForm">
                        <div class="mb-3">
                            <label for="userName" class="form-label">您的暱稱</label>
                            <input type="text" class="form-control" id="userName" placeholder="請輸入暱稱" required>
                        </div>

                        <div id="voteOptionsContainer" class="mb-3">
                            <!-- Vote options will be rendered here -->
                        </div>

                        <button type="submit" class="btn btn-success">投票</button>
                    </form>
                </div>
            </div>

            <!-- Results Section -->
            <div id="resultsArea" class="card mt-4">
                <div class="card-header">
                    <h5>投票結果</h5>
                </div>
                <div class="card-body">
                    <div id="resultsContainer">
                        <!-- Results will be rendered here -->
                    </div>
                </div>
            </div>

            <!-- Countdown Timer Section -->
            <div id="countdownContainer" class="mt-4">
                <!-- Countdown will be rendered here -->
            </div>

            <!-- Chart Section -->
            <div id="chartSection" class="card mt-4" style="display: none;">
                <div class="card-header">
                    <h5>視覺化結果</h5>
                </div>
                <div class="card-body">
                    <canvas id="pollChart"></canvas>
                </div>
            </div>

            <!-- Export and Share Section -->
            <div class="card mt-4">
                <div class="card-header">
                    <h5>分享與導出</h5>
                </div>
                <div class="card-body">
                    <button class="btn btn-info me-2" onclick="copyShareLink(currentPoll?.id)">
                        📋 複製分享連結
                    </button>
                    <button class="btn btn-warning me-2" onclick="showQRCode(currentPoll?.id)">
                        📱 顯示二維碼
                    </button>
                    <button class="btn btn-success" onclick="exportToCSV(currentPoll)">
                        📊 導出 CSV
                    </button>
                </div>
            </div>

            <!-- QR Code Container -->
            <div id="qrContainer" class="card mt-4" style="display: none;">
                <div class="card-header">
                    <h5>分享二維碼</h5>
                </div>
                <div class="card-body text-center">
                    <!-- QR Code will be rendered here -->
                </div>
            </div>
        </div>
    </div>

    <!-- GUN.js -->
    <script src="https://cdn.jsdelivr.net/npm/gun@0.2023.10/gun.js"></script>
    <!-- Gun Lib for easier usage -->
    <script src="https://cdn.jsdelivr.net/npm/gun@0.2023.10/sea.js"></script>
    
    <!-- Chart.js 圖表庫 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    
    <!-- QRCode.js 二維碼庫 -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>

    <!-- Custom modules -->
    <script src="src/gun-client.js"></script>
    <script src="src/poll-manager.js"></script>
    <script src="src/app.js"></script>
</body>
</html>
