# PRD - 投票問卷系統

## 願景
建立一個純前端、無伺服器的即時投票問卷平台，幫助大眾快速發起投票、收集意見、進行實時決策。所有數據通過 GUN.js 分散式同步，確保參與者看到最新結果。

---

## 產品定義

### 目標使用者
- 需要進行快速投票或問卷調查的個人與小團體
- 會議主持人、課堂教師、活動組織者
- 任何想即時收集意見的人

### 核心價值主張
- **無需後端**：純前端應用，開啟即用
- **即時同步**：多個參與者同時投票，結果實時更新
- **隱私優先**：數據不存伺服器，基於 GUN 分散式存儲
- **完全匿名**：無需登入，系統自動生成匿名 ID，完全隱私
- **繁體中文介面**：全程使用繁體中文，支援中文題目與選項

---

## MVP 功能清單

### 1. 投票發起者功能
- [ ] 建立投票（標題 + 選項）
- [ ] 設定投票題目類型：單選 / 多選
- [ ] 生成投票連結或 ID 供他人參與
- [ ] 即時查看投票進度與結果
- [ ] 刪除投票

### 2. 參與者功能
- [ ] **匿名進入**（無需登入，系統自動生成匿名 ID）
- [ ] 查看投票題目與所有選項
- [ ] 投票（單選或多選）
- [ ] 實時查看投票結果（票數、百分比）
- [ ] 修改投票（改變選項）

### 3. 全局功能
- [ ] 即時同步（多 tab 或多設備）
- [ ] 投票計時（可選：設定投票截止時間）
- [ ] 投票結果展示（列表 / 圖表）

---

## 資料模型

### Poll（投票）
```json
{
  "id": "poll_<timestamp>_<random>",
  "title": "你最喜歡的開發語言？",
  "type": "single",  // "single" 或 "multiple"
  "options": [
    {
      "id": "opt_1",
      "text": "JavaScript",
      "votes": 5
    },
    {
      "id": "opt_2",
      "text": "Python",
      "votes": 3
    }
  ],
  "createdAt": 1700000000,
  "createdBy": "User_1",
  "status": "active",  // "active" 或 "closed"
  "totalVotes": 8
}
```

### Vote（投票記錄）
```json
{
  "id": "vote_<timestamp>_<random>",
  "pollId": "poll_xxx",
  "userId": "User_1",
  "selectedOptions": ["opt_1"],  // 單選或多選
  "timestamp": 1700000010
}
```

---

## 驗收標準 & 測試案例

### TC-1: 建立投票
- **前置條件**：使用者打開應用
- **步驟**：
  1. 填入投票標題
  2. 輸入投票選項（至少 2 個）
  3. 選擇題目類型（單選 / 多選）
  4. 點擊「建立投票」
- **預期結果**：投票建立成功，生成唯一 ID，頁面顯示投票結果頁面

### TC-2: 參與投票
- **前置條件**：投票已建立，有至少 2 個選項
- **步驟**：
  1. 使用者輸入暱稱
  2. 選擇一個選項
  3. 點擊「投票」
- **預期結果**：投票記錄保存，該選項票數 +1

### TC-3: 即時同步
- **前置條件**：投票已建立，最少 2 個瀏覽器標籤或設備打開同一投票
- **步驟**：
  1. 標籤 A 投票
  2. 觀察標籤 B 的結果是否更新
- **預期結果**：標籤 B 在 1 秒內看到標籤 A 的投票結果

### TC-4: 修改投票
- **前置條件**：使用者已投票
- **步驟**：
  1. 使用者重新選擇不同選項
  2. 點擊「投票」
- **預期結果**：舊選項票數 -1，新選項票數 +1，總票數不變

### TC-5: 投票統計
- **前置條件**：投票已有多個參與者的投票
- **步驟**：
  1. 查看投票結果界面
- **預期結果**：正確計算並顯示每個選項的票數和百分比

### TC-6: 資料持久化
- **前置條件**：投票已建立並有投票記錄
- **步驟**：
  1. 關閉瀏覽器
  2. 重新打開應用及投票頁面
- **預期結果**：投票與所有投票記錄仍存在

---

## 技術棧

- **前端框架**：原生 JavaScript（無框架依賴）
- **UI/樣式**：原生 CSS + Bootstrap CDN（可選）
- **資料庫**：GUN.js（分散式）
- **測試**：Mocha + Chai（CDN 版）
- **部署**：靜態 HTML，無需伺服器

---

## 開發流程 - TDD

1. **Red** — 編寫失敗的測試（定義預期行為）
2. **Green** — 編寫最小實現讓測試通過
3. **Refactor** — 優化代碼（保持測試通過）

測試框架使用 Mocha + Chai，運行在瀏覽器環境中。

---

## 成功指標

- ✅ 所有測試用例通過
- ✅ 投票即時同步無延遲
- ✅ 多人同時投票無衝突
- ✅ UI 易用，無複雜操作
- ✅ 數據持久化可靠

---

## 後續可擴展功能（不在 MVP）

- 投票截止時間設置
- 投票結果分享（二維碼）
- 匿名投票選項
- 圖表展示（柱狀圖、餅圖）
- 投票結果導出（CSV）
- 身份驗證與投票權限管理

